# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   @file           :   tasks/Unifi/ssh.yaml
#   @description    :   Unifi SSH tasks
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
---
- name: "{{ ansible_os_family }} | main | set authorized key(s) for users"
  ansible.posix.authorized_key:
    user: "{{ item.username }}"
    key: '{{ item.authorized_keys | default([]) | join("\n") }}'
    state: present
  when:
    - '"authorized_keys" in item'
  loop: "{{ users }}"
