---
nameOverride: &app mealie
additionalContainers:
  api:
    name: mealie-api
    image: docker.io/hkotel/mealie:api-nightly@sha256:61b7a22585b722a99b7f7cbed3aaed84bfac9abca1e0dd86f589d1ba4a29c50c
    imagePullPolicy: IfNotPresent
    env:
      - name: ALLOW_SIGNUP
        value: "false"
      - name: API_PORT
        value: "9000"
      - name: BASE_URL
        value: "https://recipes.${SECRET_DOMAIN}"
      - name: DEFAULT_EMAIL
        value: "admin@${SECRET_DOMAIN}"
    ports:
      - name: api
        containerPort: 9000
    volumeMounts:
      - name: api-data
        mountPath: /app/data/
      - name: backup
        mountPath: /config/Backups
image:
  repository: docker.io/hkotel/mealie
  tag: frontend-nightly@sha256:3c46415f7d72ab3f199d93527df50f4a390ca8c1ff276623eef2d0a0dd85a638
ingress:
  main:
    annotations:
      external-dns.home.arpa/enabled: "true"
      hajimari.io/appName: Recipes
      hajimari.io/group: Home
      hajimari.io/icon: mdi:food
    enabled: true
    hosts:
      - host: &host "recipes.${SECRET_DOMAIN}"
        paths:
          - path: /
            pathType: Prefix
    ingressClassName: nginx
    tls:
      - hosts:
          - *host
persistence:
  api-data:
    enabled: true
    existingClaim: mealie-config-v2
  backup:
    enabled: true
    mountPath: /config/Backups
    path: "${NAS_NFS_PATH}/backup/app/mealie"
    server: "${NAS_ADDRESS}"
    type: nfs
service:
  main:
    ports:
      api:
        enabled: true
        port: 9000
      http:
        port: 3000
