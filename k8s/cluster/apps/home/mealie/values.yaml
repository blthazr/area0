---
nameOverride: &app mealie
api:
  env:
    ALLOW_SIGNUP: false
    API__PORT: &api-port 9000
    BASE_URL: "https://recipes.${SECRET_DOMAIN}"
    DEFAULT_EMAIL: "admin@${SECRET_DOMAIN}"
    TZ: "${CLUSTER_TIME_ZONE}"
  image:
    repository: hkotel/mealie
    tag: api-v1.0.0beta-3
  volumeMounts:
    - name: api-data
      mountPath: /app/data/
    - name: backup
      mountPath: /app/data/backups
env:
  MEALIE__PORT: &app-port 3000
  TZ: "${CLUSTER_TIME_ZONE}"
image:
  repository: hkotel/mealie
  tag: frontend-v1.0.0beta-3
ingress:
  main:
    annotations:
      external-dns.alpha.kubernetes.io/target: "hsv-1.${SECRET_DOMAIN}"
      external-dns/is-public: "true"
    enabled: true
    hosts:
      - host: &host "recipes.${SECRET_DOMAIN}"
        paths:
          - path: /
            pathType: Prefix
    ingressClassName: nginx
    tls:
      - hosts:
          - *host
persistence:
  api-data:
    enabled: true
    existingClaim: mealie-config-v2
  backup:
    enabled: true
    mountPath: /app/data/backups
    path: "${NAS_NFS_PATH}/backup/app/mealie"
    server: "${NAS_ADDRESS}"
    type: nfs
service:
  main:
    ports:
      api:
        enabled: true
        port: *api-port
      http:
        port: *app-port
