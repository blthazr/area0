---
# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: '3'

vars:
  FLUX_CLUSTER_SECRET_SOPS_FILE: '{{.KUBERNETES_DIR}}/flux/vars/cluster-secrets.sops.yaml'
  FLUX_CLUSTER_SETTINGS_FILE: '{{.KUBERNETES_DIR}}/flux/vars/cluster-settings.yaml'

tasks:

  # task flux:verify
  verify:
    desc: Verify flux meets the prerequisites
    cmds:
      - flux check --pre
    preconditions:
      - { msg: "flux not in $PATH", sh: "command -v flux" }
