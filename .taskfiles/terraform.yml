# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   @file           :   .taskfiles/terraform.yml
#   @description    :   terraform tasks
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
---
version: "3"

vars:
  TERRAFORM_DIR: "{{.PROJECT_DIR}}/terraform"

tasks:
  # task terraform:init:cloudflare
  init:cloudflare:
    desc: initialize terraform dependencies
    cmds:
      - terraform init
    dir: "{{.TERRAFORM_DIR}}/cloudflare"

  # task terraform:plan:cloudflare
  plan:cloudflare:
    desc: generate execution plan
    cmds:
      - terraform plan
    dir: "{{.TERRAFORM_DIR}}/cloudflare"

  # task terraform:apply:cloudflare
  apply:cloudflare:
    desc: execute generated plan
    cmds:
      - terraform apply
    dir: "{{.TERRAFORM_DIR}}/cloudflare"

  # task terraform:init:minio
  init:minio:
    desc: initialize terraform dependencies
    cmds:
      - terraform init
    dir: "{{.TERRAFORM_DIR}}/minio"

  # task terraform:plan:minio
  plan:minio:
    desc: generate execution plan
    cmds:
      - terraform plan
    dir: "{{.TERRAFORM_DIR}}/minio"

  # task terraform:apply:minio
  apply:minio:
    desc: execute generated plan
    cmds:
      - terraform apply
    dir: "{{.TERRAFORM_DIR}}/minio"
