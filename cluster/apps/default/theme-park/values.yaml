---
nameOverride: &app theme-park
controller:
  replicas: 1
  strategy: RollingUpdate
env:
  THEME_PARK__PORT: &port 8080
  TZ: "${CLUSTER_TIME_ZONE}"
image:
  repository: ghcr.io/onedr0p/theme-park
  tag: 1.13.1@sha256:d6931110411d0681175aa12bbe9c5a5981b049777c5308b6b8046f27e2ed982f
ingress:
  main:
    annotations:
      external-dns.alpha.kubernetes.io/target: "hsv-1.${SECRET_DOMAIN}"
      external-dns/is-public: "true"
    enabled: true
    hosts:
      - host: &host "{{ .Release.Name }}.${SECRET_DOMAIN}"
        paths:
          - path: /
            pathType: Prefix
    ingressClassName: nginx
    tls:
      - hosts:
          - *host
resources:
  limits:
    memory: 50Mi
  requests:
    cpu: 5m
    memory: 10Mi
service:
  main:
    ports:
      http:
        port: *port
topologySpreadConstraints:
  - labelSelector:
      matchLabels:
        app.kubernetes.io/name: *app
    maxSkew: 1
    topologyKey: kubernetes.io/hostname
    whenUnsatisfiable: DoNotSchedule
